name: Notify Slack on New Release

# Define the workflow as a reusable template
on:
  workflow_call:
    inputs:
      repo:
        description: "GitHub repository name"
        required: true
        type: string
      tag_name:
        description: "Release HTML URL"
        required: true
        type: string
      body:
        description: "Release body content"
        required: true
        type: string

jobs:
  notify-slack:
    runs-on: ubuntu-latest
    steps:
      - name: Send Slack Notification
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
          REPO: ${{ inputs.repo }}
          BODY: ${{ inputs.body }}

        run: |
          curl -X POST -H 'Content-type: application/json' --data "{
            \"text\": \"*Ny versjon av spor er ute!* ðŸ“¦âœ¨ \n
          ðŸ“– *Changelog*: <${HTML_URL}|${TAG_NAME}> \n
          ðŸ“¦ *Installer*: \`npm i @vygruppen/spor-react@latest\` \n \"
          }" $SLACK_WEBHOOK_URL ${BODY}
