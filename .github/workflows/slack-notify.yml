name: Notify Slack on New Release

on:
  workflow_call:
    inputs:
      repo:
        description: "GitHub repository name"
        required: true
        type: string
      tag_name:
        description: "Release tag name"
        required: true
        type: string
      body:
        description: "Release body content"
        required: true
        type: string

jobs:
  notify-slack:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Send Slack Notification
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: |
          curl -X POST -H 'Content-type: application/json' --data "{
            \"text\": \"*Ny versjon av spor er ute!* 📦✨ \n
            📖 *Changelog*: <https://github.com/${{ inputs.repo }}/releases/tag/${{ inputs.tag_name }}|${{ inputs.tag_name }}> \n
            📦 *Installer*: \`npm i @vygruppen/spor-react@latest\` \n
            📝 *Details*: ${{ inputs.body }} \"
          }" $SLACK_WEBHOOK_URL
